

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Playbooks &mdash; IBM Power Systems AIX 1.0.0-beta1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Roles" href="roles.html" />
    <link rel="prev" title="user – Create new users or change/remove attributes of users on AIX." href="modules/user.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> IBM Power Systems AIX
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Playbooks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#playbook-documentation">Playbook Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sample-configuration-and-setup">Sample Configuration and Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inventory">Inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#group-vars">Group_vars</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-the-playbooks">Run the playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#log-and-debug">Log and debug</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="roles.html">Roles</a></li>
</ul>
<p class="caption"><span class="caption-text">Community Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="community_guides.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="community_guides.html#helpful-links">Helpful Links</a></li>
</ul>
<p class="caption"><span class="caption-text">Requirements</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Requirements</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Releases</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">IBM Power Systems AIX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Playbooks</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/IBM/ansible-power-aix/blob/dev-collection/docs/source/playbooks.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="playbooks">
<h1>Playbooks<a class="headerlink" href="#playbooks" title="Permalink to this headline">¶</a></h1>
<p>The sample playbooks that are <strong>included</strong> in the <strong>IBM Power Systems AIX collection</strong>
demonstrate how to use the collection content.</p>
<div class="section" id="playbook-documentation">
<h2>Playbook Documentation<a class="headerlink" href="#playbook-documentation" title="Permalink to this headline">¶</a></h2>
<p>An <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_intro.html#playbooks-intro">Ansible playbook</a> consists of organized instructions that define work for
a managed node (host) to be managed with Ansible.</p>
<p>A <a class="reference external" href="https://github.com/IBM/ansible-power-aix/tree/dev-collection/playbooks">playbooks directory</a> that contains a sample playbook is included in the
<strong>IBM Power Systems AIX collection</strong>. The sample playbook can be run with the
<code class="docutils literal notranslate"><span class="pre">ansible-playbook</span></code> command with some modification to the <strong>inventory</strong>
and <strong>group_vars</strong>.</p>
<p>You can find the playbook content that is included with the collection in the
same location where the collection is installed. For more information, refer to
the <a class="reference external" href="installation.html">installation documentation</a>. In the following examples, this document will
refer to the installation path as <code class="docutils literal notranslate"><span class="pre">~/.ansible/collections/ansible_collections/ibm/power_aix</span></code>.</p>
</div>
<div class="section" id="sample-configuration-and-setup">
<h2>Sample Configuration and Setup<a class="headerlink" href="#sample-configuration-and-setup" title="Permalink to this headline">¶</a></h2>
<p>Each release of Ansible provides options in addition to the ones identified in
the sample configurations that are included with this collection. These options
allow you to customize how Ansible operates in your environment. Ansible
supports several sources to configure its behavior and all sources follow the
Ansible <a class="reference external" href="https://docs.ansible.com/ansible/latest/reference_appendices/general_precedence.html#general-precedence-rules">precedence rules</a>.</p>
<p>The Ansible configuration file <cite>ansible.cfg</cite> can override almost all
<code class="docutils literal notranslate"><span class="pre">ansible-playbook</span></code> configurations.</p>
<p>You can specify the SSH port used by Ansible and instruct Ansible where to
write the temporary files on the target. This can be easily done by adding the
options to your inventory or <cite>ansible.cfg</cite>.</p>
<p>For more information about available configurations for <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code>, read
the Ansible documentation on <a class="reference external" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#ansible-configuration-settings-locations">Ansible configuration settings</a>.</p>
</div>
<div class="section" id="inventory">
<h2>Inventory<a class="headerlink" href="#inventory" title="Permalink to this headline">¶</a></h2>
<p>Ansible works with multiple managed nodes (hosts) at the same time, using a
list or group of lists known as an <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html">inventory</a>. Once the inventory is defined,
you can use <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/intro_patterns.html#intro-patterns">patterns</a> to select the hosts or groups that you want Ansible to
run against.</p>
<p>Included in the <a class="reference external" href="https://github.com/IBM/ansible-power-aix/tree/dev-collection/playbooks">playbooks directory</a> is a <a class="reference external" href="https://github.com/IBM/ansible-power-aix/blob/dev-collection/playbooks/inventory.yml">sample inventory file</a> that can be
used to manage your nodes with a little modification. This inventory file
should be included when running the sample playbook.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">nimserver</span><span class="p">:</span>
  <span class="nt">hosts</span><span class="p">:</span>
    <span class="nt">nim</span><span class="p">:</span>
      <span class="nt">ansible_host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">aix_target_address</span>
      <span class="nt">ansible_user</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">aix_target_username</span>
      <span class="nt">ansible_python_interpreter</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">path_to_python_interpreter_binary_on_aix_target</span>
</pre></div>
</div>
<p>The value for the property <strong>ansible_host</strong> is the hostname of the managed node;
for example, <code class="docutils literal notranslate"><span class="pre">ansible_host:</span> <span class="pre">regency.aus.stglabs.ibm.com</span></code></p>
<p>The value for the property <strong>aix_target_username</strong> is the user name to use when
connecting to the host; for example, <code class="docutils literal notranslate"><span class="pre">ansible_user:</span> <span class="pre">padmin</span></code>.</p>
<p>The value for the property <strong>ansible_python_interpreter</strong> is the target host
Python path. This is useful for systems with more than one Python installation,
or when Python is not installed in the default location <strong>/usr/bin/python</strong>;
for example, <code class="docutils literal notranslate"><span class="pre">ansible_python_interpreter:</span> <span class="pre">/usr/lpp/rsusr/python36/bin/python</span></code></p>
</div>
<div class="section" id="group-vars">
<h2>Group_vars<a class="headerlink" href="#group-vars" title="Permalink to this headline">¶</a></h2>
<p>Although you can store variables in the inventory file, storing separate host
and group variables files may help you organize your variable values more
easily. Included with the sample playbook are sample variables files <a class="reference external" href="https://github.com/IBM/ansible-power-aix/blob/dev-collection/playbooks/group_vars/all.yml">all.yml</a>
and <a class="reference external" href="https://github.com/IBM/ansible-power-aix/blob/dev-collection/playbooks/group_vars/nimserver.yml">nimserver.yml</a>.</p>
</div>
<div class="section" id="run-the-playbooks">
<h2>Run the playbooks<a class="headerlink" href="#run-the-playbooks" title="Permalink to this headline">¶</a></h2>
<p>The sample playbooks must be run from the <a class="reference external" href="https://github.com/IBM/ansible-power-aix/tree/dev-collection/playbooks">playbooks directory</a> of the installed
collection: <code class="docutils literal notranslate"><span class="pre">~/.ansible/collections/ansible_collections/ibm/power_aix/playbooks/</span></code>.</p>
<p>Access the sample Ansible playbook and ensure that you are within the collection
playbooks directory where the sample files are included:
<code class="docutils literal notranslate"><span class="pre">~/.ansible/collections/ansible_collections/ibm/power_aix/playbooks/</span></code>.</p>
<p>Use the Ansible command <code class="docutils literal notranslate"><span class="pre">ansible-playbook</span></code> to run the sample playbooks.  The
command syntax is <code class="docutils literal notranslate"><span class="pre">ansible-playbook</span> <span class="pre">-i</span> <span class="pre">&lt;inventory&gt;</span> <span class="pre">&lt;playbook&gt;</span></code>; for example,
<code class="docutils literal notranslate"><span class="pre">ansible-playbook</span> <span class="pre">-i</span> <span class="pre">inventory</span> <span class="pre">demo_flrtvc.yml</span></code>.</p>
<p>This command assumes that the controller’s public SSH key has been shared with
the managed node. If you want to avoid entering a username and password each
time, copy the SSH public key to the managed node using the <code class="docutils literal notranslate"><span class="pre">ssh-copy-id</span></code>
command; for example, <code class="docutils literal notranslate"><span class="pre">ssh-copy-id</span> <span class="pre">-i</span> <span class="pre">~/.ssh/mykey.pub</span> <span class="pre">user&#64;&lt;hostname&gt;</span></code>.</p>
<p>Alternatively, you can use the <code class="docutils literal notranslate"><span class="pre">--ask-pass</span></code> option to be prompted for the
user’s password each time a playbook is run; for example,
<code class="docutils literal notranslate"><span class="pre">ansible-playbook</span> <span class="pre">-i</span> <span class="pre">inventory</span> <span class="pre">demo_flrtvc.yml</span> <span class="pre">--ask-pass</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Using <code class="docutils literal notranslate"><span class="pre">--ask-pass</span></code> is not recommended because it will hinder performance.</p></li>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">--ask-pass</span></code> requires <code class="docutils literal notranslate"><span class="pre">sshpass</span></code> be installed on the controller.
For further reference, see the <a class="reference external" href="https://linux.die.net/man/1/sshpass">ask-pass documentation</a>.</p></li>
</ul>
</div>
<p>Optionally, you can configure the console logging verbosity during playbook
execution. This is helpful in situations where communication is failing and
you want to obtain more details. To adjust the logging verbosity, append more
letter <cite>v</cite>’s; for example, <cite>-v</cite>, <cite>-vv</cite>, <cite>-vvv</cite>, or <cite>-vvvv</cite>.</p>
<p>Each letter <cite>v</cite> increases logging verbosity similar to traditional logging
levels INFO, WARN, ERROR, DEBUG.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is a good practice to review the playbook samples before executing them.
It will help you understand what requirements in terms of space, location,
names, authority, and artifacts will be created and cleaned up. Although
samples are always written to operate without the need for the user’s
configuration, flexibility is written into the samples because it is not
easy to determine if a sample has access to the host’s resources.
Review the playbook notes sections for additional details and
configuration.</p>
</div>
</div>
<div class="section" id="log-and-debug">
<h2>Log and debug<a class="headerlink" href="#log-and-debug" title="Permalink to this headline">¶</a></h2>
<p>The <strong>IBM Power Systems AIX collection</strong> uses the standard Ansible log system
that is using the syslog subsystem on the managed nodes.</p>
<p>To activate AIX syslog you can update the configuration file <cite>/etc/syslog.conf</cite>
with a selector <cite>user.info</cite> (or <cite>user.debug</cite> for more details) such as:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ vi /etc/syslog.conf
user.info /var/log/syslog.user.info rotate size 1m files <span class="m">4</span> compress
</pre></div>
</div>
<p>and restarting syslogd subsystem and look for Ansible logs:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ &gt;/var/log/syslog.user.info
$ refresh -s syslogd

$ grep ansible /var/log/syslog.user.info
May  <span class="m">6</span> <span class="m">03</span>:28:27 nimmaster user:info ansible-nim: Invoked with <span class="nv">resource</span><span class="o">=</span>None <span class="nv">force</span><span class="o">=</span>False <span class="nv">description</span><span class="o">=</span>None <span class="nv">script</span><span class="o">=</span>damien_script <span class="nv">lpp_source</span><span class="o">=</span>None <span class="nv">action</span><span class="o">=</span>script <span class="nv">asynchronous</span><span class="o">=</span>True <span class="nv">location</span><span class="o">=</span>None <span class="nv">device</span><span class="o">=</span>None <span class="nv">group</span><span class="o">=</span>None <span class="nv">operation</span><span class="o">=</span>None <span class="nv">targets</span><span class="o">=[</span><span class="s1">&#39;nimclient01&#39;</span><span class="o">]</span>
May  <span class="m">6</span> <span class="m">03</span>:28:27 nimmaster user:info ansible-nim: *** START ***
...
</pre></div>
</div>
<p>To see the full debug log messages you should set the selector field to
<cite>user.debug</cite> and run the playbook with the environment variable
<cite>ANSIBLE_DEBUG=1</cite></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ vi /etc/syslog.conf
user.debug /var/log/syslog.user.debug rotate size 1m files <span class="m">4</span> compress
$ &gt;/var/log/syslog.user.debug
$ refresh -s syslogd
$ <span class="nv">ANSIBLE_DEBUG</span><span class="o">=</span><span class="m">1</span> ansible-playbook -M plugins/modules ./demo_nim.yml -vvv
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="roles.html" class="btn btn-neutral float-right" title="Roles" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="modules/user.html" class="btn btn-neutral float-left" title="user – Create new users or change/remove attributes of users on AIX." accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, IBM.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>